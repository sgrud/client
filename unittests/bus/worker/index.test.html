<!doctype html>
<meta charset="utf-8">

<script type="importmap">
  {
    "imports": {
      "@babel/runtime/helpers/": "/node_modules/@babel/runtime/helpers/esm/",
      "@sgrud/bus": "/node_modules/@sgrud/bus/index.modern.js",
      "@sgrud/core": "/node_modules/@sgrud/core/index.modern.js",
      "comlink": "/node_modules/comlink/dist/esm/comlink.min.js",
      "rxjs": "/node_modules/rxjs/dist/esm5/index.js",
      "rxjs/ajax": "/node_modules/rxjs/dist/esm5/ajax/index.js",
      "tslib": "/node_modules/tslib/tslib.es6.js"
    }
  }
</script>

<script type="module">
  import { BusHandler } from '@sgrud/bus';
  import { firstValueFrom, Subject } from 'rxjs';

  const handler = new BusHandler();
  const bus = new Subject();

  handler.set('sgrud.test.bus.worker', bus).subscribe();
  setTimeout(() => bus.next('@sgrud/bus/worker'), 250);

  window.bus = firstValueFrom(handler.get('sgrud.test.bus.worker'));
</script>
